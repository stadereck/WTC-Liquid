<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>iOS 26 Liquid Glass - Hello Edition</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@300;400;600&display=swap');

        :root {
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
            --app-bg: #f2f2f7;
            --app-text: #000;
            --accent: #007aff;
            --list-bg: #fff;
            --border-color: #e5e5ea;
        }

        /* MODO OSCURO GLOBAL */
        .iphone-frame.dark-mode {
            --app-bg: #000;
            --app-text: #fff;
            --glass-bg: rgba(30, 30, 30, 0.6);
            --list-bg: #1c1c1e;
            --border-color: #38383a;
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif; background: #111; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        
        #scaler { transition: transform 0.1s; display: flex; gap: 20px; align-items: center; }

        .iphone-frame {
            width: 380px; height: 800px; background: #000; border-radius: 55px;
            position: relative; box-shadow: 0 0 0 12px #1a1a1a, 0 0 0 14px #4a4a4a, 0 20px 50px rgba(0,0,0,0.5);
            overflow: hidden; z-index: 10; transition: background 0.3s;
        }

        /* --- PANTALLA DE BIENVENIDA (HELLO) --- */
        #welcomeScreen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 5000; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
            transition: transform 0.8s cubic-bezier(0.6, -0.28, 0.735, 0.045);
        }
        #welcomeText {
            font-family: 'Dancing Script', cursive; font-size: 60px; font-weight: 700;
            opacity: 0; transition: opacity 1s; color: black;
        }
        .swipe-hint-text {
            position: absolute; bottom: 50px; font-family: -apple-system, sans-serif;
            font-weight: 500; font-size: 16px; opacity: 0; animation: fadeUp 2s infinite;
        }
        @keyframes fadeUp { 0% { opacity: 0; transform: translateY(10px); } 50% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-10px); } }

        /* --- TUTORIAL --- */
        #tutorialOverlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 4000;
            display: none; flex-direction: column; justify-content: center; align-items: center;
            color: white; padding: 40px; text-align: center;
        }
        .tut-card {
            background: #1c1c1e; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            transform: scale(0.9); opacity: 0; transition: all 0.5s;
        }
        .tut-card.active { transform: scale(1); opacity: 1; }
        .tut-btn {
            margin-top: 20px; background: #007aff; border: none; padding: 12px 24px;
            border-radius: 25px; color: white; font-weight: 600; font-size: 16px; cursor: pointer;
        }

        /* FONDOS */
        .wallpaper-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;
            background: linear-gradient(135deg, #021B79, #0575E6, #00F260);
            background-size: 400% 400%; animation: gradientAnim 15s ease infinite;
        }
        @keyframes gradientAnim { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* ISLA DINÁMICA */
        .notch {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            width: 120px; height: 35px; background: #000; border-radius: 20px; z-index: 2000;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: white; overflow: hidden; display: flex; align-items: center; justify-content: space-between; padding: 0 12px;
            cursor: pointer;
        }
        .notch.expanded-charge { width: 220px; height: 50px; border-radius: 25px; justify-content: center; background: #000; border: 1px solid #333; }
        .notch.expanded-faceid { width: 160px; height: 160px; border-radius: 40px; justify-content: center; flex-direction: column; }
        
        .notch-content { display: none; width: 100%; opacity: 0; transition: opacity 0.2s; }
        .notch.expanded-charge .charge-ui, .notch.expanded-faceid .faceid-ui { display: flex; opacity: 1; align-items: center; justify-content: center; gap: 10px; }
        
        .scan-line { width: 50px; height: 50px; border: 2px solid #007aff; border-radius: 10px; position: relative; }
        .scan-line::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: #007aff; animation: scan 1.5s infinite; }
        @keyframes scan { 0% { top: 0; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }

        /* PANTALLA DE BLOQUEO */
        .lock-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000;
            background: linear-gradient(135deg, #021B79, #0575E6, #00F260);
            background-size: 400% 400%; animation: gradientAnim 15s ease infinite;
            display: flex; flex-direction: column; align-items: center;
            transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .lock-screen.unlocked { transform: translateY(-100%); }
        
        .clock-container { margin-top: 80px; text-align: center; color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .lock-time { font-size: 90px; font-weight: 700; letter-spacing: -3px; line-height: 1; }
        .lock-date { font-size: 20px; font-weight: 500; text-transform: capitalize; margin-top: 5px; }
        .lock-shortcuts { margin-top: auto; margin-bottom: 50px; width: 100%; display: flex; justify-content: space-between; padding: 0 40px; }
        .glass-btn { width: 50px; height: 50px; border-radius: 50%; background: rgba(0,0,0,0.4); backdrop-filter: blur(20px); display: flex; justify-content: center; align-items: center; color: white; cursor: pointer; }

        /* HOME SCREEN */
        .home-screen { position: relative; z-index: 1; padding: 70px 20px 20px 20px; height: 100%; display: flex; flex-direction: column; gap: 20px; }
        .app-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px 10px; padding: 10px 0; overflow-y: auto; scrollbar-width: none; }
        .app-grid::-webkit-scrollbar { display: none; }
        .app-item { display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; }
        
        .app-icon { width: 62px; height: 62px; border-radius: 14px; display: flex; justify-content: center; align-items: center; background: var(--glass-bg); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 4px 10px rgba(0,0,0,0.2); color: white; font-size: 28px; position: relative; overflow: hidden; }
        .icon-mail { background: linear-gradient(#007aff, #00c6ff); }
        .icon-cal { background: #fff; color: #ff3b30; flex-direction: column; font-size: 10px; font-weight: 800; gap: 2px; }
        .icon-cal span { font-size: 28px; color: #000; }
        .icon-maps { background: #4cd964; }
        .icon-clock { background: #000; color: #fff; border: 1px solid #333; }
        .icon-weather { background: #5ac8fa; }
        .icon-phone { background: #34c759; }
        .icon-messages { background: #34c759; }
        .icon-wallet { background: #000; border: 1px solid #333; }
        .icon-settings { background: #8e8e93; }
        .app-name { font-size: 11px; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.8); }

        .dock-bar { margin-top: auto; width: 100%; height: 95px; border-radius: 35px; background: rgba(255,255,255,0.2); backdrop-filter: blur(30px); display: flex; justify-content: space-evenly; align-items: center; border: 1px solid rgba(255,255,255,0.2); }

        /* WINDOWS */
        .app-window { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--app-bg); color: var(--app-text); z-index: 1100; display: flex; flex-direction: column; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1); border-radius: 55px; overflow: hidden; }
        .app-window.open { transform: translateY(0); }
        .nav-bar { height: 90px; padding: 45px 20px 10px 20px; display: flex; align-items: center; justify-content: space-between; background: rgba(245,245,245,0.9); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0,0,0,0.1); font-weight: 600; z-index: 20; }
        .iphone-frame.dark-mode .nav-bar { background: #1c1c1e; border-bottom: 1px solid #333; color: white; }
        .app-body { flex: 1; overflow-y: auto; }

        /* CAMERA UI ENHANCED */
        .camera-app { background: black !important; color: white; display: flex; flex-direction: column; }
        .cam-controls { padding: 20px; background: black; display: flex; justify-content: space-around; align-items: center; height: 150px; }
        .cam-modes { display: flex; justify-content: center; gap: 20px; padding: 10px; font-size: 13px; font-weight: 600; color: #888; text-transform: uppercase; background: black; }
        .cam-modes .active { color: #f0c330; }
        .shutter { width: 70px; height: 70px; border-radius: 50%; border: 4px solid white; position: relative; }
        .shutter::after { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); width: 56px; height: 56px; background: white; border-radius: 50%; transition: 0.1s; }
        .shutter:active::after { transform: translate(-50%,-50%) scale(0.9); }
        .cam-filter-btn { width: 40px; height: 40px; border-radius: 50%; background: #333; display: flex; justify-content: center; align-items: center; }

        /* Estilos Listas */
        .list-group { background: var(--list-bg); margin: 20px; border-radius: 12px; overflow: hidden; }
        .list-item { padding: 15px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .list-item:last-child { border-bottom: none; }
        
        .toggle { width: 50px; height: 30px; background: #e9e9ea; border-radius: 15px; position: relative; transition: 0.3s; }
        .toggle.active { background: #34c759; }
        .toggle-handle { width: 26px; height: 26px; background: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .toggle.active .toggle-handle { transform: translateX(20px); }

        /* Wallet Styles */
        .card-container { perspective: 1000px; padding: 20px; }
        .credit-card { background: linear-gradient(135deg, #1a1a1a, #444); border-radius: 15px; height: 200px; color: white; padding: 25px; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .card-chip { width: 40px; height: 30px; background: #ffd700; border-radius: 5px; margin-bottom: 20px; }
        .card-number { font-size: 22px; letter-spacing: 2px; font-family: monospace; margin-bottom: 20px; }
        .cvc-bar { width: 40px; height: 4px; background: #555; border-radius: 2px; margin-top: 5px; overflow: hidden; }
        .cvc-progress { width: 100%; height: 100%; background: #34c759; transition: width 1s linear; }

        /* Home Indicator & Status Bar Transition */
        .home-indicator { 
            position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); 
            width: 130px; height: 5px; background: white; border-radius: 10px; z-index: 2000; cursor: pointer; 
            transition: background-color 0.6s cubic-bezier(0.25, 1, 0.5, 1); /* Animación hermosa */
        }
        
        .home-indicator.dark {
            background-color: #000; /* Color oscuro para apps claras */
        }

        .status-bar { 
            position: absolute; top: 15px; width: 100%; padding: 0 25px; 
            display: flex; justify-content: space-between; color: white; 
            font-size: 14px; font-weight: 600; z-index: 2000;
            transition: color 0.6s cubic-bezier(0.25, 1, 0.5, 1); /* Animación hermosa */
        }
        
        .status-bar.dark {
            color: #000; /* Texto oscuro para apps claras */
        }

        /* Calculator Grid */
        .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; padding: 20px; background: black; height: 100%; align-content: end; }
        .calc-btn { height: 70px; border-radius: 35px; background: #333; color: white; display: flex; justify-content: center; align-items: center; font-size: 24px; cursor: pointer; }
        .calc-btn.orange { background: #ff9f0a; } .calc-btn.light { background: #a5a5a5; color: black; }

        /* Phone Keypad */
        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; padding: 40px; justify-items: center; }
        .key-btn { width: 70px; height: 70px; background: #e5e5ea; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 24px; cursor: pointer; }
        .call-btn { grid-column: 2; background: #34c759; color: white; }

    </style>
</head>
<body>

    <div id="scaler">
        <div class="iphone-frame" id="iphoneFrame">
            
            <!-- BIENVENIDA / HELLO SCREEN -->
            <div id="welcomeScreen" onclick="startSetup()">
                <div id="welcomeText">hello</div>
                <div class="swipe-hint-text">Desliza para empezar</div>
            </div>

            <!-- TUTORIAL -->
            <div id="tutorialOverlay">
                <div class="tut-card active" id="tut1">
                    <h2>Bienvenido a iOS 26</h2>
                    <p style="margin:20px 0; opacity:0.8;">Liquid Glass UI</p>
                    <p>Experimenta el nuevo diseño hiperrealista y fluido.</p>
                    <button class="tut-btn" onclick="nextTut(1)">Siguiente</button>
                </div>
                <div class="tut-card" id="tut2">
                    <h2>Isla Dinámica</h2>
                    <p style="margin:20px 0; opacity:0.8;">Interactiva y Viva</p>
                    <p>La isla reacciona a la carga y notificaciones. Pruébalo en Ajustes.</p>
                    <button class="tut-btn" onclick="nextTut(2)">Siguiente</button>
                </div>
                <div class="tut-card" id="tut3">
                    <h2>Gestos</h2>
                    <p style="margin:20px 0; opacity:0.8;">Navegación Fluida</p>
                    <p>Usa la barra inferior para ir al inicio desde cualquier app.</p>
                    <button class="tut-btn" onclick="closeTutorial()">Empezar</button>
                </div>
            </div>

            <!-- PANTALLA BLOQUEO -->
            <div class="lock-screen" id="lockScreen">
                <div class="clock-container">
                    <div style="font-size:16px; margin-bottom:5px;"><i data-lucide="lock" size="14"></i></div>
                    <div class="lock-time" id="lockTime">--:--</div>
                    <div class="lock-date" id="lockDate">...</div>
                </div>
                <div class="lock-shortcuts">
                    <div class="glass-btn"><i data-lucide="flashlight"></i></div>
                    <div class="glass-btn" onclick="openApp('camera')"><i data-lucide="camera"></i></div>
                </div>
                <div style="position:absolute; top:0; width:100%; height:100%;" onclick="unlockPhone()"></div>
            </div>

            <div class="wallpaper-layer" id="wallpaper"></div>

            <!-- HOME SCREEN -->
            <div class="home-screen">
                <div class="app-grid">
                    <div class="app-item" onclick="openApp('mail')"><div class="app-icon icon-mail"><i data-lucide="mail"></i></div><span class="app-name">Mail</span></div>
                    <div class="app-item" onclick="openApp('calendar')"><div class="app-icon icon-cal">DOM<span>28</span></div><span class="app-name">Calendario</span></div>
                    <div class="app-item" onclick="openApp('photos')"><div class="app-icon" style="background:white;"><i data-lucide="image" color="#ff2d55"></i></div><span class="app-name">Fotos</span></div>
                    <div class="app-item" onclick="openApp('camera')"><div class="app-icon" style="background:#ccc;"><i data-lucide="camera" color="#000"></i></div><span class="app-name">Cámara</span></div>
                    
                    <div class="app-item" onclick="openApp('maps')"><div class="app-icon icon-maps"><i data-lucide="map-pinned"></i></div><span class="app-name">Mapas</span></div>
                    <div class="app-item" onclick="openApp('clock')"><div class="app-icon icon-clock"><i data-lucide="clock"></i></div><span class="app-name">Reloj</span></div>
                    <div class="app-item" onclick="openApp('weather')"><div class="app-icon icon-weather"><i data-lucide="cloud-sun"></i></div><span class="app-name">Clima</span></div>
                    <div class="app-item" onclick="openApp('wallet')"><div class="app-icon icon-wallet"><i data-lucide="wallet-cards"></i></div><span class="app-name">Cartera</span></div>
                    
                    <div class="app-item" onclick="openApp('notes')"><div class="app-icon" style="background:#ffd60a; color:white;"><i data-lucide="file-text"></i></div><span class="app-name">Notas</span></div>
                    <div class="app-item" onclick="openApp('calculator')"><div class="app-icon" style="background:#000; color:white;"><i data-lucide="calculator"></i></div><span class="app-name">Calculadora</span></div>
                    <div class="app-item" onclick="openApp('settings')"><div class="app-icon icon-settings"><i data-lucide="settings-2"></i></div><span class="app-name">Ajustes</span></div>
                </div>

                <div class="dock-bar">
                    <div class="app-item" onclick="openApp('phone')"><div class="app-icon icon-phone"><i data-lucide="phone"></i></div></div>
                    <div class="app-item" onclick="openApp('safari')"><div class="app-icon" style="background:white; color:#007aff;"><i data-lucide="compass"></i></div></div>
                    <div class="app-item" onclick="openApp('messages')"><div class="app-icon icon-messages"><i data-lucide="message-circle"></i></div></div>
                    <div class="app-item" onclick="openApp('music')"><div class="app-icon" style="background:#ff2d55;"><i data-lucide="music"></i></div></div>
                </div>
            </div>

            <!-- ISLA DINÁMICA -->
            <div class="notch" id="notch">
                <div class="notch-content charge-ui">
                    <i data-lucide="zap" color="#34c759"></i> <span style="color:#34c759; font-weight:600;">Cargando 100%</span>
                </div>
                <div class="notch-content faceid-ui">
                    <div class="scan-line"></div>
                </div>
            </div>

            <!-- WINDOWS -->

            <!-- CAMERA (PRO) -->
            <div id="app-camera" class="app-window" style="z-index: 1200;">
                <div class="camera-app" style="height:100%;">
                    <div style="flex:1; position:relative; overflow:hidden;">
                        <video id="camFeed" autoplay playsinline style="width:100%; height:100%; object-fit:cover; transform:scaleX(-1);"></video>
                        <div style="position:absolute; top:20px; width:100%; display:flex; justify-content:space-between; padding:0 20px;">
                            <i data-lucide="zap-off"></i>
                            <i data-lucide="chevron-up"></i>
                            <i data-lucide="aperture"></i>
                        </div>
                    </div>
                    <div class="cam-modes">
                        <span>Cine</span><span>Video</span><span class="active">Foto</span><span>Retrato</span><span>Pano</span>
                    </div>
                    <div class="cam-controls">
                        <div style="width:50px; height:50px; background:#333; border-radius:5px; overflow:hidden;" onclick="openApp('photos')">
                            <img id="lastPhoto" style="width:100%; height:100%; object-fit:cover; display:none;">
                        </div>
                        <div class="shutter" onclick="takePhoto()"></div>
                        <div class="cam-filter-btn" onclick="toggleFilter()"><i data-lucide="filter" size="20"></i></div>
                    </div>
                </div>
                <canvas id="photoCanvas" style="display:none;"></canvas>
            </div>

            <!-- SETTINGS -->
            <div id="app-settings" class="app-window">
                <div class="nav-bar"><div onclick="closeApp('settings')" style="color:var(--accent)">Atrás</div><div>Ajustes</div><div></div></div>
                <div class="app-body">
                    <h1 style="padding:20px 20px 0;">Ajustes</h1>
                    <div class="list-group">
                        <div class="list-item"><div style="display:flex; gap:10px;"><i data-lucide="user"></i> Usuario</div><div style="color:#888">Apple ID</div></div>
                    </div>
                    <div class="list-group">
                        <div class="list-item"><div style="display:flex; gap:10px;"><i data-lucide="moon" style="color:#5856d6"></i> Modo Oscuro</div><div class="toggle" id="darkToggle" onclick="toggleDark()"><div class="toggle-handle"></div></div></div>
                        <div class="list-item" onclick="triggerChargeAnim()"><div style="display:flex; gap:10px;"><i data-lucide="zap" style="color:#34c759"></i> Simular Carga</div><div style="color:#888">Probar</div></div>
                    </div>
                </div>
            </div>

            <!-- WALLET -->
            <div id="app-wallet" class="app-window">
                <div class="nav-bar" style="background:black; color:white; border:none;"><div></div><div>Cartera</div><div onclick="closeApp('wallet')">Listo</div></div>
                <div class="app-body" style="background:black; color:white;">
                    <div class="card-container">
                        <div class="credit-card">
                            <div style="display:flex; justify-content:space-between;">
                                <div class="card-chip"></div>
                                <div class="card-cvc-timer">
                                    <div style="font-size:10px; color:#aaa;">CVC Dinámico</div>
                                    <div style="font-weight:bold; color:#fff;" id="walletCVC">---</div>
                                    <div class="cvc-bar"><div class="cvc-progress" id="cvcProgress"></div></div>
                                </div>
                            </div>
                            <div class="card-number" id="walletNum">**** **** **** ****</div>
                            <div style="display:flex; justify-content:space-between;">
                                <div style="font-weight:600;">JUAN PEREZ</div>
                                <div style="font-weight:600;">12/28</div>
                            </div>
                        </div>
                    </div>
                    <div class="balance-section">
                        <div style="color:#aaa; font-size:14px;">Saldo Total</div>
                        <div class="balance-amount">$5,000.00 <span style="font-size:20px;">USD</span></div>
                    </div>
                    <div class="trans-list">
                        <h4 style="margin-bottom:10px; color:#888;">Hoy</h4>
                        <div class="trans-item">
                            <div style="display:flex; gap:10px;"><div style="background:#fff; width:40px; height:40px; border-radius:50%; display:flex; justify-content:center; align-items:center;"><i data-lucide="coffee" color="black"></i></div><div>Starbucks</div></div>
                            <div>-$5.50</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- OTHER APPS (Mail, Phone, etc. placeholders for full functionality) -->
            <div id="app-mail" class="app-window"><div class="nav-bar"><div>Buzones</div><div>Entrada</div><div onclick="closeApp('mail')">Listo</div></div><div class="app-body"><div class="list-item"><div><b>Apple</b><br>Recibo</div><div>Ayer</div></div></div></div>
            <div id="app-phone" class="app-window"><div class="app-body" style="display:flex; flex-direction:column; justify-content:flex-end;"><div id="phoneDisplay" style="font-size:32px; text-align:center; padding:20px;"></div><div class="keypad"><div class="key-btn" onclick="dial('1')">1</div><div class="key-btn" onclick="dial('2')">2</div><div class="key-btn" onclick="dial('3')">3</div><div class="key-btn" onclick="dial('4')">4</div><div class="key-btn" onclick="dial('5')">5</div><div class="key-btn" onclick="dial('6')">6</div><div class="key-btn" onclick="dial('7')">7</div><div class="key-btn" onclick="dial('8')">8</div><div class="key-btn" onclick="dial('9')">9</div><div class="key-btn" onclick="dial('*')">*</div><div class="key-btn" onclick="dial('0')">0</div><div class="key-btn" onclick="dial('#')">#</div><div class="key-btn call-btn" onclick="alert('Llamando...')"><i data-lucide="phone"></i></div></div></div></div>
            <div id="app-calculator" class="app-window"><div class="app-body" style="background:black; color:white; display:flex; flex-direction:column; justify-content:flex-end;"><div id="calcRes" style="text-align:right; font-size:80px; padding:20px;">0</div><div class="calc-grid"><div class="calc-btn light" onclick="calc('C')">AC</div><div class="calc-btn light">+/-</div><div class="calc-btn light">%</div><div class="calc-btn orange" onclick="calc('/')">÷</div><div class="calc-btn" onclick="calc(7)">7</div><div class="calc-btn" onclick="calc(8)">8</div><div class="calc-btn" onclick="calc(9)">9</div><div class="calc-btn orange" onclick="calc('*')">×</div><div class="calc-btn" onclick="calc(4)">4</div><div class="calc-btn" onclick="calc(5)">5</div><div class="calc-btn" onclick="calc(6)">6</div><div class="calc-btn orange" onclick="calc('-')">-</div><div class="calc-btn" onclick="calc(1)">1</div><div class="calc-btn" onclick="calc(2)">2</div><div class="calc-btn" onclick="calc(3)">3</div><div class="calc-btn orange" onclick="calc('+')">+</div><div class="calc-btn" style="grid-column:span 2; justify-content:flex-start; padding-left:30px;" onclick="calc(0)">0</div><div class="calc-btn">.</div><div class="calc-btn orange" onclick="calc('=')">=</div></div></div></div>
            
            <!-- EXTRAS -->
            <div id="app-calendar" class="app-window"><div class="nav-bar"><div style="color:red">2026</div><div>Calendario</div><div onclick="closeApp('calendar')">Hoy</div></div><div class="app-body" style="padding:20px; text-align:center;"><h1 style="color:red;">ABRIL</h1></div></div>
            <div id="app-photos" class="app-window"><div class="nav-bar"><div style="color:#007aff" onclick="closeApp('photos')">Atrás</div><div>Fotos</div><div></div></div><div class="app-body" style="background:white;"><div class="grid-3" id="photoGrid"></div></div></div>
            <div id="app-maps" class="app-window"><div class="app-body"><iframe width="100%" height="100%" frameborder="0" src="https://www.openstreetmap.org/export/embed.html"></iframe></div></div>
            <div id="app-clock" class="app-window"><div class="app-body" style="background:black; color:white; padding:20px; padding-top:60px;"><h1>9:41</h1>Ciudad de México</div></div>
            <div id="app-weather" class="app-window"><div class="app-body" style="background:linear-gradient(#1e3c72, #2a5298); color:white; text-align:center; padding-top:60px;"><h1>22°</h1>Soleado</div></div>
            <div id="app-notes" class="app-window"><div class="nav-bar"><div style="color:#ffd60a">Atrás</div><div>Notas</div><div onclick="closeApp('notes')">Listo</div></div><div class="app-body"><textarea style="width:100%; height:100%; border:none; padding:20px; font-size:18px;">Nueva nota...</textarea></div></div>
            <div id="app-safari" class="app-window"><div class="app-body"><div style="padding:10px; background:#eee; text-align:center;">apple.com</div><iframe src="https://www.bing.com" style="width:100%; height:100%; border:none;"></iframe></div></div>
            <div id="app-messages" class="app-window"><div class="nav-bar"><div>Editar</div><div>Mensajes</div><div></div></div><div class="app-body" style="padding:20px;">Sin mensajes</div></div>
            <div id="app-music" class="app-window"><div class="app-body" style="background:#111;"><iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator&theme=0" width="100%" height="100%" frameBorder="0" allowfullscreen="" loading="lazy"></iframe></div></div>

            <div class="home-indicator" id="homeIndicator" onclick="goHome()"></div>
            <div class="status-bar" id="statusBar"><span id="statusBarClock">9:41</span><div style="display:flex; gap:5px;"><i data-lucide="signal" size="14"></i><i data-lucide="wifi" size="14"></i><i data-lucide="battery-full" size="18"></i></div></div>

        </div>
    </div>

    <script>
        lucide.createIcons();
        
        // HELLO SEQUENCE
        const greetings = ["hello", "hola", "bonjour", "ciao", "hallo", "olá"];
        let greetIdx = 0;
        const welcomeText = document.getElementById('welcomeText');
        
        const greetInterval = setInterval(() => {
            welcomeText.style.opacity = 0;
            setTimeout(() => {
                greetIdx = (greetIdx + 1) % greetings.length;
                welcomeText.innerText = greetings[greetIdx];
                welcomeText.style.opacity = 1;
            }, 500);
        }, 2000);

        function startSetup() {
            clearInterval(greetInterval);
            document.getElementById('welcomeScreen').style.transform = "translateY(-100%)";
            document.getElementById('tutorialOverlay').style.display = "flex";
        }

        // TUTORIAL
        function nextTut(n) {
            document.getElementById('tut'+n).classList.remove('active');
            document.getElementById('tut'+(n+1)).classList.add('active');
        }
        function closeTutorial() {
            document.getElementById('tutorialOverlay').style.display = "none";
        }

        // SYSTEM
        function updateClock() {
            const d = new Date();
            const t = d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
            document.getElementById('lockTime').innerText = t;
            document.getElementById('statusBarClock').innerText = t;
            const o = {weekday:'long', day:'numeric', month:'long'};
            document.getElementById('lockDate').innerText = d.toLocaleDateString('es-ES', o);
        }
        setInterval(updateClock, 1000); updateClock();

        function resize() {
            const s = Math.min((window.innerWidth-20)/380, (window.innerHeight-20)/800, 1);
            document.getElementById('scaler').style.transform = `scale(${s})`;
        }
        window.onresize = resize; window.onload = resize;

        function unlockPhone() {
            const n = document.getElementById('notch');
            n.classList.add('expanded-faceid');
            setTimeout(() => {
                n.classList.remove('expanded-faceid');
                document.getElementById('lockScreen').classList.add('unlocked');
            }, 1000);
        }

        function goHome() {
            document.querySelectorAll('.app-window').forEach(w => w.classList.remove('open'));
            clearInterval(cvcInterval);
            // RESET INDICATOR COLORS ON EXIT
            document.getElementById('homeIndicator').classList.remove('dark');
            document.getElementById('statusBar').classList.remove('dark');
        }

        const lightApps = ['mail', 'calendar', 'photos', 'maps', 'notes', 'settings', 'phone', 'safari', 'messages'];

        function openApp(id) {
            if(id === 'wallet') startWallet();
            if(id === 'camera') startCamera();
            const app = document.getElementById('app-' + id);
            if(app) {
                app.classList.add('open');
                // CHECK IF LIGHT APP AND APPLY DARK UI
                if(lightApps.includes(id)) {
                    document.getElementById('homeIndicator').classList.add('dark');
                    document.getElementById('statusBar').classList.add('dark');
                }
            }
        }
        function closeApp(id) {
            document.getElementById('app-' + id).classList.remove('open');
            if(id === 'wallet') clearInterval(cvcInterval);
            if(id === 'camera') stopCamera();
            goHome(); // Ensure colors reset
        }

        // SETTINGS & DARK MODE
        function toggleDark() {
            document.getElementById('iphoneFrame').classList.toggle('dark-mode');
            document.getElementById('darkToggle').classList.toggle('active');
        }
        function triggerChargeAnim() {
            const n = document.getElementById('notch');
            n.classList.add('expanded-charge');
            setTimeout(() => n.classList.remove('expanded-charge'), 3000);
        }

        // CAMERA
        let videoStream;
        let filterIdx = 0;
        const filters = ['none', 'grayscale(1)', 'sepia(1)', 'saturate(2)'];
        async function startCamera() {
            try {
                videoStream = await navigator.mediaDevices.getUserMedia({ video: true });
                document.getElementById('camFeed').srcObject = videoStream;
            } catch(e) {}
        }
        function stopCamera() {
            if(videoStream) videoStream.getTracks().forEach(t => t.stop());
        }
        function toggleFilter() {
            filterIdx = (filterIdx + 1) % filters.length;
            document.getElementById('camFeed').style.filter = filters[filterIdx];
        }
        function takePhoto() {
            const c = document.getElementById('photoCanvas');
            const v = document.getElementById('camFeed');
            c.width = v.videoWidth; c.height = v.videoHeight;
            const ctx = c.getContext('2d');
            ctx.filter = filters[filterIdx];
            ctx.drawImage(v,0,0);
            document.getElementById('lastPhoto').src = c.toDataURL('image/jpeg');
            document.getElementById('lastPhoto').style.display = 'block';
        }

        // WALLET
        let cvcInterval;
        function startWallet() {
            let num = "";
            for(let i=0; i<4; i++) num += Math.floor(1000 + Math.random() * 9000) + " ";
            document.getElementById('walletNum').innerText = num.trim();

            function updateCVC() {
                document.getElementById('walletCVC').innerText = Math.floor(100 + Math.random() * 900);
                const bar = document.getElementById('cvcProgress');
                bar.style.transition = 'none'; bar.style.width = '100%';
                setTimeout(() => { bar.style.transition = 'width 30s linear'; bar.style.width = '0%'; }, 10);
            }
            updateCVC();
            clearInterval(cvcInterval);
            cvcInterval = setInterval(updateCVC, 30000);
        }

        // PHONE & CALC
        function dial(n) { document.getElementById('phoneDisplay').innerText += n; }
        let cVal = "0";
        function calc(v) {
            const d = document.getElementById('calcRes');
            if(v==='C') cVal="0";
            else if(v==='=') { try{cVal=eval(cVal)}catch{cVal="Error"} }
            else { if(cVal==="0") cVal=""; cVal+=v; }
            d.innerText = cVal;
        }

    </script>
</body>
</html>
