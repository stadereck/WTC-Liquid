<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WTC Liquid 2026 Edition</title>
    <!-- Favicon en la pestaña del navegador como "Title" real -->
    <link rel="icon" href="https://www.svgrepo.com/show/503173/apple-logo.svg" type="image/svg+xml">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@300;400;600&display=swap');

        :root {
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
            --app-bg: #f2f2f7;
            --app-text: #000;
            --accent: #007aff;
            --list-bg: #fff;
            --border-color: #e5e5ea;
        }

        .iphone-frame.dark-mode {
            --app-bg: #000;
            --app-text: #fff;
            --glass-bg: rgba(30, 30, 30, 0.6);
            --list-bg: #1c1c1e;
            --border-color: #38383a;
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif; background: #111; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        
        #scaler { transition: transform 0.1s; display: flex; gap: 20px; align-items: center; }

        .iphone-frame {
            width: 380px; height: 800px; background: #000; border-radius: 55px;
            position: relative; box-shadow: 0 0 0 12px #1a1a1a, 0 0 0 14px #4a4a4a, 0 20px 50px rgba(0,0,0,0.5);
            overflow: hidden; z-index: 10; transition: background 0.3s;
        }

        /* --- PANTALLA AÑO NUEVO (NUEVA) --- */
        #newYearOverlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #000000, #1a0b2e);
            z-index: 9999; /* Encima de todo */
            display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
            opacity: 1;
            transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1);
        }
        #newYearOverlay.fade-out {
            opacity: 0;
            pointer-events: none;
        }
        #nyCanvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
        }
        .ny-text {
            z-index: 2; color: white;
            font-family: 'Dancing Script', cursive;
            animation: zoomIn 1.5s ease-out;
        }
        .ny-title {
            font-size: 50px;
            background: linear-gradient(to right, #FFD700, #FFA500, #FFD700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        .ny-subtitle {
            font-family: 'Inter', sans-serif;
            font-size: 24px;
            color: #ccc;
            opacity: 0;
            animation: fadeIn 1s ease-out 1s forwards;
        }
        @keyframes zoomIn { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }


        /* --- PANTALLA DE BIENVENIDA (HELLO) --- */
        #welcomeScreen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 5000; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
            transition: transform 0.8s cubic-bezier(0.6, -0.28, 0.735, 0.045);
        }
        #welcomeText {
            font-family: 'Dancing Script', cursive; font-size: 60px; font-weight: 700;
            opacity: 0; transition: opacity 1s; color: black;
        }
        .swipe-hint-text {
            position: absolute; bottom: 50px; font-family: -apple-system, sans-serif;
            font-weight: 500; font-size: 16px; opacity: 0; animation: fadeUp 2s infinite; color: #888;
        }
        @keyframes fadeUp { 0% { opacity: 0; transform: translateY(10px); } 50% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-10px); } }

        /* --- ISLA DINÁMICA --- */
        .notch {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            width: 120px; height: 35px; background: #000; border-radius: 20px; 
            z-index: 6000;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: white; overflow: hidden; display: flex; align-items: center; justify-content: space-between; padding: 0 12px;
            cursor: pointer; box-shadow: 0 0 0 0px transparent;
        }
        
        /* Animación Aura Boreal para Bienvenida */
        .notch.welcome-aura {
            animation: islandBreathe 3s infinite alternate;
            box-shadow: 0 0 20px 2px rgba(0, 122, 255, 0.6), 0 0 40px 5px rgba(50, 255, 100, 0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }
        @keyframes islandBreathe {
            0% { box-shadow: 0 0 15px 1px rgba(0, 122, 255, 0.5), 0 0 30px 2px rgba(200, 50, 255, 0.2); }
            100% { box-shadow: 0 0 25px 4px rgba(50, 200, 255, 0.8), 0 0 50px 8px rgba(50, 255, 100, 0.4); }
        }

        /* Estados de la Isla */
        .notch.expanded-charge { width: 240px; height: 50px; border-radius: 25px; justify-content: center; background: #000; border: 1px solid #333; }
        .notch.expanded-faceid { width: 160px; height: 160px; border-radius: 40px; justify-content: center; flex-direction: column; }
        
        .notch.expanded-language {
            width: 280px; height: 60px; border-radius: 30px; justify-content: center;
            background: linear-gradient(45deg, #000, #1a1a1a);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 0 30px rgba(0,122,255,0.5);
        }

        .notch-content { display: none; width: 100%; opacity: 0; transition: opacity 0.2s; }
        .notch.expanded-charge .charge-ui, 
        .notch.expanded-faceid .faceid-ui,
        .notch.expanded-language .lang-ui { display: flex; opacity: 1; align-items: center; justify-content: center; gap: 10px; }
        
        .globe-spin { animation: spin 2s linear infinite; color: #007aff; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        .scan-line { width: 50px; height: 50px; border: 2px solid #007aff; border-radius: 10px; position: relative; }
        .scan-line::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: #007aff; animation: scan 1.5s infinite; }
        @keyframes scan { 0% { top: 0; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }

        /* FONDOS */
        .wallpaper-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;
            background: linear-gradient(135deg, #021B79, #0575E6, #00F260);
            background-size: 400% 400%; animation: gradientAnim 15s ease infinite;
        }
        @keyframes gradientAnim { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* LOCK SCREEN */
        .lock-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000;
            background: linear-gradient(135deg, #021B79, #0575E6, #00F260);
            background-size: 400% 400%; animation: gradientAnim 15s ease infinite;
            display: flex; flex-direction: column; align-items: center;
            transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .lock-screen.unlocked { transform: translateY(-100%); }
        .clock-container { margin-top: 80px; text-align: center; color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .lock-time { font-size: 90px; font-weight: 700; letter-spacing: -3px; line-height: 1; }
        .lock-date { font-size: 20px; font-weight: 500; text-transform: capitalize; margin-top: 5px; }
        .lock-shortcuts { margin-top: auto; margin-bottom: 50px; width: 100%; display: flex; justify-content: space-between; padding: 0 40px; }
        .glass-btn { width: 50px; height: 50px; border-radius: 50%; background: rgba(0,0,0,0.4); backdrop-filter: blur(20px); display: flex; justify-content: center; align-items: center; color: white; cursor: pointer; }

        /* HOME SCREEN */
        .home-screen { 
            position: relative; z-index: 1; 
            padding: 60px 20px 20px 20px; /* Reduced top padding from 70px */
            height: 100%; display: flex; flex-direction: column; 
            gap: 15px; /* Reduced gap from 20px */
        }
        .app-grid { 
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px 8px; /* Tighter gap */
            padding: 5px 0; /* Reduced padding */
            overflow-y: auto; scrollbar-width: none; 
        }
        .app-grid::-webkit-scrollbar { display: none; }
        .app-item { display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer; }
        
        .app-icon { width: 62px; height: 62px; border-radius: 14px; display: flex; justify-content: center; align-items: center; background: var(--glass-bg); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 4px 10px rgba(0,0,0,0.2); color: white; font-size: 28px; position: relative; overflow: hidden; }
        .icon-cal { background: #fff; color: #ff3b30; flex-direction: column; font-size: 10px; font-weight: 800; gap: 2px; }
        .icon-cal span { font-size: 28px; color: #000; }
        .icon-maps { background: #4cd964; }
        .icon-clock { background: #000; color: #fff; border: 1px solid #333; }
        .icon-weather { background: #5ac8fa; }
        .icon-phone { background: #34c759; }
        .icon-messages { background: #34c759; }
        .icon-wallet { background: #000; border: 1px solid #333; }
        .app-name { font-size: 11px; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.8); }
        .dock-bar { margin-top: auto; width: 100%; height: 95px; border-radius: 35px; background: rgba(255,255,255,0.2); backdrop-filter: blur(30px); display: flex; justify-content: space-evenly; align-items: center; border: 1px solid rgba(255,255,255,0.2); }

        /* WINDOWS */
        .app-window { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--app-bg); color: var(--app-text); z-index: 1100; display: flex; flex-direction: column; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1); border-radius: 55px; overflow: hidden; }
        .app-window.open { transform: translateY(0); }
        .nav-bar { height: 90px; padding: 45px 20px 10px 20px; display: flex; align-items: center; justify-content: space-between; background: rgba(245,245,245,0.9); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0,0,0,0.1); font-weight: 600; z-index: 20; }
        .iphone-frame.dark-mode .nav-bar { background: #1c1c1e; border-bottom: 1px solid #333; color: white; }
        .app-body { flex: 1; overflow-y: auto; }

        /* CAMERA */
        .camera-app { background: black !important; color: white; display: flex; flex-direction: column; }
        .cam-controls { padding: 20px; background: black; display: flex; justify-content: space-around; align-items: center; height: 150px; }
        .shutter { width: 70px; height: 70px; border-radius: 50%; border: 4px solid white; position: relative; }
        .shutter::after { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); width: 56px; height: 56px; background: white; border-radius: 50%; transition: 0.1s; }
        .shutter:active::after { transform: translate(-50%,-50%) scale(0.9); }

        /* LISTAS & SETTINGS */
        .list-group { background: var(--list-bg); margin: 20px; border-radius: 12px; overflow: hidden; }
        .list-item { padding: 15px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .list-item:last-child { border-bottom: none; }
        .toggle { width: 50px; height: 30px; background: #e9e9ea; border-radius: 15px; position: relative; transition: 0.3s; }
        .toggle.active { background: #34c759; }
        .toggle-handle { width: 26px; height: 26px; background: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .toggle.active .toggle-handle { transform: translateX(20px); }

        /* WALLET */
        .credit-card { background: linear-gradient(135deg, #1a1a1a, #444); border-radius: 15px; height: 200px; color: white; padding: 25px; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .cvc-progress { width: 100%; height: 100%; background: #34c759; transition: width 1s linear; }

        .home-indicator { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); width: 130px; height: 5px; background: white; border-radius: 10px; z-index: 2000; cursor: pointer; transition: background-color 0.6s cubic-bezier(0.25, 1, 0.5, 1); }
        .home-indicator.dark { background-color: #000; }
        .status-bar { position: absolute; top: 15px; width: 100%; padding: 0 25px; display: flex; justify-content: space-between; color: white; font-size: 14px; font-weight: 600; z-index: 2000; transition: color 0.6s cubic-bezier(0.25, 1, 0.5, 1); }
        .status-bar.dark { color: #000; }

        /* PHONE & CALC */
        .keypad, .calc-grid { display: grid; gap: 12px; padding: 20px; justify-items: center; }
        .key-btn, .calc-btn { width: 70px; height: 70px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 24px; cursor: pointer; }
        .key-btn { background: #e5e5ea; }
        .calc-btn { background: #333; color: white; }
        .calc-btn.orange, .call-btn { background: #ff9f0a; color: white; } .call-btn { background: #34c759; }

        /* SETTINGS PAGES */
        .settings-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; background: var(--app-bg); transition: transform 0.3s ease; padding-top: 90px; }
        .settings-page.hidden { transform: translateX(100%); }
        .settings-page.main { z-index: 1; padding-top: 0; }
        .settings-page.sub { z-index: 2; }

    </style>
</head>
<body>

    <div id="scaler">
        <div class="iphone-frame" id="iphoneFrame">
            
            <!-- AÑO NUEVO OVERLAY -->
            <div id="newYearOverlay">
                <canvas id="nyCanvas"></canvas>
                <div class="ny-text">
                    <div class="ny-title">Feliz Año Nuevo<br>2026</div>
                    <div class="ny-subtitle">Gracias por todo!</div>
                </div>
            </div>

            <!-- BIENVENIDA / HELLO SCREEN -->
            <div id="welcomeScreen" onclick="startSetup()">
                <div id="welcomeText">hello</div>
                <div class="swipe-hint-text" id="swipeText">Desliza para empezar</div>
            </div>

            <!-- ISLA DINÁMICA (Aura Welcome) -->
            <div class="notch welcome-aura" id="notch">
                <div class="notch-content charge-ui">
                    <i data-lucide="zap" color="#34c759"></i> <span style="color:#34c759; font-weight:600;" id="notchChargeText">Cargando 100%</span>
                </div>
                <div class="notch-content faceid-ui">
                    <div class="scan-line"></div>
                    <span style="font-size:12px; margin-top:5px;" id="notchFaceIdText">Face ID</span>
                </div>
                <div class="notch-content lang-ui">
                    <i data-lucide="globe" class="globe-spin"></i> <span style="font-weight:600;" id="langNotchText">Cambiando Idioma...</span>
                </div>
            </div>

            <!-- TUTORIAL -->
            <div id="tutorialOverlay">
                <div class="tut-card active" id="tut1">
                    <h2>Bienvenido a iOS 26</h2>
                    <p style="margin:20px 0; opacity:0.8;">Liquid Glass UI</p>
                    <button class="tut-btn" onclick="nextTut(1)">Siguiente</button>
                </div>
                <div class="tut-card" id="tut2">
                    <h2>Isla Dinámica</h2>
                    <p style="margin:20px 0; opacity:0.8;">Interactiva y Viva</p>
                    <button class="tut-btn" onclick="nextTut(2)">Siguiente</button>
                </div>
                <div class="tut-card" id="tut3">
                    <h2>Gestos</h2>
                    <p style="margin:20px 0; opacity:0.8;">Navegación Fluida</p>
                    <button class="tut-btn" onclick="closeTutorial()">Empezar</button>
                </div>
            </div>

            <!-- PANTALLA BLOQUEO -->
            <div class="lock-screen" id="lockScreen">
                <div class="clock-container">
                    <div style="font-size:16px; margin-bottom:5px;"><i data-lucide="lock" size="14"></i></div>
                    <div class="lock-time" id="lockTime">--:--</div>
                    <div class="lock-date" id="lockDate">...</div>
                </div>
                <div class="lock-shortcuts">
                    <div class="glass-btn"><i data-lucide="flashlight"></i></div>
                    <div class="glass-btn" onclick="openApp('camera')"><i data-lucide="camera"></i></div>
                </div>
                <div style="position:absolute; top:0; width:100%; height:100%;" onclick="unlockPhone()"></div>
            </div>

            <div class="wallpaper-layer" id="wallpaper"></div>

            <!-- HOME SCREEN (Adjusted Spacing) -->
            <div class="home-screen">
                <div class="app-grid">
                    <!-- MAIL -->
                    <div class="app-item" onclick="openApp('mail')">
                        <div class="app-icon"><img src="https://i.ibb.co/Rp6zxQc4/250.jpg" style="width:100%;height:100%;object-fit:cover;"></div>
                        <span class="app-name" data-key="mail">Mail</span>
                    </div>
                    <div class="app-item" onclick="openApp('calendar')"><div class="app-icon icon-cal">DOM<span>28</span></div><span class="app-name" data-key="calendar">Calendario</span></div>
                    <div class="app-item" onclick="openApp('photos')"><div class="app-icon" style="background:white;"><i data-lucide="image" color="#ff2d55"></i></div><span class="app-name" data-key="photos">Fotos</span></div>
                    <div class="app-item" onclick="openApp('camera')"><div class="app-icon" style="background:#ccc;"><i data-lucide="camera" color="#000"></i></div><span class="app-name" data-key="camera">Cámara</span></div>
                    
                    <div class="app-item" onclick="openApp('maps')"><div class="app-icon icon-maps"><i data-lucide="map-pinned"></i></div><span class="app-name" data-key="maps">Mapas</span></div>
                    <div class="app-item" onclick="openApp('clock')"><div class="app-icon icon-clock"><i data-lucide="clock"></i></div><span class="app-name" data-key="clock">Reloj</span></div>
                    <div class="app-item" onclick="openApp('weather')"><div class="app-icon icon-weather"><i data-lucide="cloud-sun"></i></div><span class="app-name" data-key="weather">Clima</span></div>
                    <div class="app-item" onclick="openApp('wallet')"><div class="app-icon icon-wallet"><i data-lucide="wallet-cards"></i></div><span class="app-name" data-key="wallet">Cartera</span></div>
                    
                    <div class="app-item" onclick="openApp('notes')"><div class="app-icon" style="background:#ffd60a; color:white;"><i data-lucide="file-text"></i></div><span class="app-name" data-key="notes">Notas</span></div>
                    <div class="app-item" onclick="openApp('calculator')">
                        <div class="app-icon"><img src="https://i.ibb.co/JRPgZLNR/images-removebg-preview.png" style="width:100%;height:100%;object-fit:cover;"></div>
                        <span class="app-name" data-key="calculator">Calculadora</span>
                    </div>
                    
                    <!-- AJUSTES -->
                    <div class="app-item" onclick="openApp('settings')">
                        <div class="app-icon"><img src="https://i.ibb.co/JS5p6Z7/Settings-29-dark-removebg-preview.png" onerror="this.style.display='none';this.parentNode.style.background='#8e8e93';this.parentNode.innerHTML='<i data-lucide=\'settings-2\'></i>'" style="width:100%;height:100%;object-fit:cover;"></div>
                        <span class="app-name" data-key="settings">Ajustes</span>
                    </div>
                </div>

                <div class="dock-bar">
                    <div class="app-item" onclick="openApp('phone')"><div class="app-icon icon-phone"><i data-lucide="phone"></i></div></div>
                    <div class="app-item" onclick="openApp('safari')"><div class="app-icon" style="background:white; color:#007aff;"><i data-lucide="compass"></i></div></div>
                    <div class="app-item" onclick="openApp('messages')"><div class="app-icon icon-messages"><i data-lucide="message-circle"></i></div></div>
                    <div class="app-item" onclick="openApp('music')"><div class="app-icon" style="background:#ff2d55;"><i data-lucide="music"></i></div></div>
                </div>
            </div>

            <!-- WINDOWS -->

            <!-- CAMERA (PRO) -->
            <div id="app-camera" class="app-window" style="z-index: 1200;">
                <div class="camera-app" style="height:100%;">
                    <div style="flex:1; position:relative; overflow:hidden;">
                        <video id="camFeed" autoplay playsinline style="width:100%; height:100%; object-fit:cover; transform:scaleX(-1);"></video>
                        <div style="position:absolute; top:20px; width:100%; display:flex; justify-content:space-between; padding:0 20px;">
                            <i data-lucide="zap-off"></i>
                            <i data-lucide="chevron-up"></i>
                            <i data-lucide="aperture"></i>
                        </div>
                    </div>
                    <div class="cam-modes">
                        <span>Cine</span><span>Video</span><span class="active">Foto</span><span>Retrato</span><span>Pano</span>
                    </div>
                    <div class="cam-controls">
                        <div style="width:50px; height:50px; background:#333; border-radius:5px; overflow:hidden;" onclick="openApp('photos')">
                            <img id="lastPhoto" style="width:100%; height:100%; object-fit:cover; display:none;">
                        </div>
                        <div class="shutter" onclick="takePhoto()"></div>
                        <div class="cam-filter-btn" onclick="toggleFilter()"><i data-lucide="filter" size="20"></i></div>
                    </div>
                </div>
                <canvas id="photoCanvas" style="display:none;"></canvas>
            </div>

            <!-- SETTINGS -->
            <div id="app-settings" class="app-window">
                <div class="nav-bar"><div id="setBackBtn" onclick="closeApp('settings')" style="color:var(--accent); cursor:pointer;">Atrás</div><div id="setTitle">Ajustes</div><div></div></div>
                <div class="app-body">
                    <!-- MAIN PAGE -->
                    <div id="setMain" class="settings-page main">
                        <h1 style="padding:20px 20px 0;" data-key="settings">Ajustes</h1>
                        <div class="list-group">
                            <div class="list-item"><div style="display:flex; gap:10px;"><i data-lucide="user"></i> Usuario</div><div style="color:#888">Apple ID</div></div>
                        </div>
                        <div class="list-group">
                            <div class="list-item" onclick="navSettings('langs')">
                                <div style="display:flex; gap:10px;"><i data-lucide="globe" style="color:#007aff"></i> <span data-key="lang_region">Idioma y Región</span></div>
                                <div style="color:#888; display:flex; align-items:center;" id="currentLangDisplay">Español <i data-lucide="chevron-right" size="16"></i></div>
                            </div>
                            <div class="list-item"><div style="display:flex; gap:10px;"><i data-lucide="moon" style="color:#5856d6"></i> <span data-key="dark_mode">Modo Oscuro</span></div><div class="toggle" id="darkToggle" onclick="toggleDark()"><div class="toggle-handle"></div></div></div>
                        </div>
                        <div class="list-group">
                            <div class="list-item" onclick="triggerChargeAnim()"><div style="display:flex; gap:10px;"><i data-lucide="zap" style="color:#34c759"></i> <span data-key="charging">Simular Carga</span></div><div style="color:#888">Probar</div></div>
                        </div>
                    </div>

                    <!-- LANGUAGES PAGE -->
                    <div id="setLangs" class="settings-page hidden sub">
                        <div class="list-group">
                            <div class="list-item" onclick="setLanguage('es')"><div>Español</div><i data-lucide="check" class="lang-check" id="check-es" style="color:#007aff"></i></div>
                            <div class="list-item" onclick="setLanguage('en')"><div>English</div><i data-lucide="check" class="lang-check" id="check-en" style="display:none; color:#007aff"></i></div>
                            <div class="list-item" onclick="setLanguage('fr')"><div>Français</div><i data-lucide="check" class="lang-check" id="check-fr" style="display:none; color:#007aff"></i></div>
                            <div class="list-item" onclick="setLanguage('it')"><div>Italiano</div><i data-lucide="check" class="lang-check" id="check-it" style="display:none; color:#007aff"></i></div>
                            <div class="list-item" onclick="setLanguage('jp')"><div>日本語</div><i data-lucide="check" class="lang-check" id="check-jp" style="display:none; color:#007aff"></i></div>
                            <div class="list-item" onclick="setLanguage('cn')"><div>中文</div><i data-lucide="check" class="lang-check" id="check-cn" style="display:none; color:#007aff"></i></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WALLET -->
            <div id="app-wallet" class="app-window">
                <div class="nav-bar" style="background:black; color:white; border:none;"><div></div><div>Cartera</div><div onclick="closeApp('wallet')">Listo</div></div>
                <div class="app-body" style="background:black; color:white;">
                    <div class="card-container">
                        <div class="credit-card">
                            <div style="display:flex; justify-content:space-between;">
                                <div class="card-chip"></div>
                                <div class="card-cvc-timer"><div style="font-size:10px; color:#aaa;">CVC</div><div style="font-weight:bold; color:#fff;" id="walletCVC">---</div><div class="cvc-bar"><div class="cvc-progress" id="cvcProgress"></div></div></div>
                            </div>
                            <div class="card-number" id="walletNum">**** **** **** ****</div>
                            <div style="display:flex; justify-content:space-between;"><div style="font-weight:600;">JUAN PEREZ</div><div style="font-weight:600;">12/28</div></div>
                        </div>
                    </div>
                    <div class="balance-section" style="text-align:center; padding:20px;">
                        <div style="color:#aaa; font-size:14px;">Saldo Total</div><div style="font-size:40px; font-weight:700;">$5,000.00</div>
                    </div>
                </div>
            </div>

            <!-- OTHER APPS -->
            <div id="app-mail" class="app-window"><div class="nav-bar"><div>Buzones</div><div>Entrada</div><div onclick="closeApp('mail')">Listo</div></div><div class="app-body"><div class="list-item"><div><b>Apple</b><br>Recibo</div><div>Ayer</div></div></div></div>
            <div id="app-phone" class="app-window"><div class="app-body" style="display:flex; flex-direction:column; justify-content:flex-end;"><div id="phoneDisplay" style="font-size:32px; text-align:center; padding:20px;"></div><div class="keypad" style="display:grid; grid-template-columns:repeat(3,1fr); gap:20px; padding:40px; justify-items:center;"><div class="key-btn" onclick="dial('1')">1</div><div class="key-btn" onclick="dial('2')">2</div><div class="key-btn" onclick="dial('3')">3</div><div class="key-btn" onclick="dial('4')">4</div><div class="key-btn" onclick="dial('5')">5</div><div class="key-btn" onclick="dial('6')">6</div><div class="key-btn" onclick="dial('7')">7</div><div class="key-btn" onclick="dial('8')">8</div><div class="key-btn" onclick="dial('9')">9</div><div class="key-btn" onclick="dial('*')">*</div><div class="key-btn" onclick="dial('0')">0</div><div class="key-btn" onclick="dial('#')">#</div><div class="key-btn" style="background:#34c759; color:white; grid-column:2;" onclick="alert('Llamando...')"><i data-lucide="phone"></i></div></div></div></div>
            <div id="app-calculator" class="app-window"><div class="app-body" style="background:black; color:white; display:flex; flex-direction:column; justify-content:flex-end;"><div id="calcRes" style="text-align:right; font-size:80px; padding:20px;">0</div><div class="calc-grid" style="display:grid; grid-template-columns:repeat(4,1fr); gap:12px; padding:20px; background:black;"><div class="calc-btn" style="background:#a5a5a5; color:black;" onclick="calc('C')">AC</div><div class="calc-btn" style="background:#a5a5a5; color:black;">+/-</div><div class="calc-btn" style="background:#a5a5a5; color:black;">%</div><div class="calc-btn" style="background:#ff9f0a;" onclick="calc('/')">÷</div><div class="calc-btn" onclick="calc(7)">7</div><div class="calc-btn" onclick="calc(8)">8</div><div class="calc-btn" onclick="calc(9)">9</div><div class="calc-btn" style="background:#ff9f0a;" onclick="calc('*')">×</div><div class="calc-btn" onclick="calc(4)">4</div><div class="calc-btn" onclick="calc(5)">5</div><div class="calc-btn" onclick="calc(6)">6</div><div class="calc-btn" style="background:#ff9f0a;" onclick="calc('-')">-</div><div class="calc-btn" onclick="calc(1)">1</div><div class="calc-btn" onclick="calc(2)">2</div><div class="calc-btn" onclick="calc(3)">3</div><div class="calc-btn" style="background:#ff9f0a;" onclick="calc('+')">+</div><div class="calc-btn" style="grid-column:span 2; justify-content:flex-start; padding-left:30px;" onclick="calc(0)">0</div><div class="calc-btn">.</div><div class="calc-btn" style="background:#ff9f0a;" onclick="calc('=')">=</div></div></div></div>
            
            <div id="app-calendar" class="app-window"><div class="nav-bar"><div style="color:red">2026</div><div>Calendario</div><div onclick="closeApp('calendar')">Hoy</div></div><div class="app-body" style="padding:20px; text-align:center;"><h1 style="color:red;">ABRIL</h1></div></div>
            <div id="app-photos" class="app-window"><div class="nav-bar"><div style="color:#007aff" onclick="closeApp('photos')">Atrás</div><div>Fotos</div><div></div></div><div class="app-body" style="background:white;"><div class="grid-3" id="photoGrid" style="display:grid; grid-template-columns:repeat(3,1fr); gap:2px;"></div></div></div>
            <div id="app-maps" class="app-window"><div class="app-body"><iframe width="100%" height="100%" frameborder="0" src="https://www.openstreetmap.org/export/embed.html"></iframe></div></div>
            <div id="app-clock" class="app-window"><div class="app-body" style="background:black; color:white; padding:20px; padding-top:60px;"><h1>9:41</h1>Ciudad de México</div></div>
            <div id="app-weather" class="app-window"><div class="app-body" style="background:linear-gradient(#1e3c72, #2a5298); color:white; text-align:center; padding-top:60px;"><h1>22°</h1>Soleado</div></div>
            <div id="app-notes" class="app-window"><div class="nav-bar"><div style="color:#ffd60a">Atrás</div><div>Notas</div><div onclick="closeApp('notes')">Listo</div></div><div class="app-body"><textarea style="width:100%; height:100%; border:none; padding:20px; font-size:18px;">Nueva nota...</textarea></div></div>
            <div id="app-safari" class="app-window"><div class="app-body"><div style="padding:10px; background:#eee; text-align:center;">apple.com</div><iframe src="https://www.bing.com" style="width:100%; height:100%; border:none;"></iframe></div></div>
            <div id="app-messages" class="app-window"><div class="nav-bar"><div>Editar</div><div>Mensajes</div><div></div></div><div class="app-body" style="padding:20px;">Sin mensajes</div></div>
            <div id="app-music" class="app-window"><div class="app-body" style="background:#111;"><iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator&theme=0" width="100%" height="100%" frameBorder="0" allowfullscreen="" loading="lazy"></iframe></div></div>

            <div class="home-indicator" id="homeIndicator" onclick="goHome()"></div>
            <div class="status-bar" id="statusBar"><span id="statusBarClock">9:41</span><div style="display:flex; gap:5px;"><i data-lucide="signal" size="14"></i><i data-lucide="wifi" size="14"></i><i data-lucide="battery-full" size="18"></i></div></div>

        </div>
    </div>

    <script>
        lucide.createIcons();
        
        // --- TRANSLATIONS CONFIG ---
        const translations = {
            es: { welcome: "Desliza para empezar", mail: "Mail", calendar: "Calendario", photos: "Fotos", camera: "Cámara", maps: "Mapas", clock: "Reloj", weather: "Clima", wallet: "Cartera", notes: "Notas", calculator: "Calculadora", settings: "Ajustes", lang_region: "Idioma y Región", dark_mode: "Modo Oscuro", charging: "Cargando", face_id: "Face ID", changing_lang: "Cambiando Idioma..." },
            en: { welcome: "Swipe to start", mail: "Mail", calendar: "Calendar", photos: "Photos", camera: "Camera", maps: "Maps", clock: "Clock", weather: "Weather", wallet: "Wallet", notes: "Notes", calculator: "Calculator", settings: "Settings", lang_region: "Language & Region", dark_mode: "Dark Mode", charging: "Charging", face_id: "Face ID", changing_lang: "Changing Language..." },
            fr: { welcome: "Balayez pour commencer", mail: "Mail", calendar: "Calendrier", photos: "Photos", camera: "Appareil photo", maps: "Plans", clock: "Horloge", weather: "Météo", wallet: "Cartes", notes: "Notes", calculator: "Calculatrice", settings: "Réglages", lang_region: "Langue et région", dark_mode: "Mode sombre", charging: "En charge", face_id: "Face ID", changing_lang: "Changement de langue..." },
            it: { welcome: "Scorri per iniziare", mail: "Mail", calendar: "Calendario", photos: "Foto", camera: "Fotocamera", maps: "Mappe", clock: "Orologio", weather: "Meteo", wallet: "Wallet", notes: "Note", calculator: "Calcolatrice", settings: "Impostazioni", lang_region: "Lingua e zona", dark_mode: "Modalità scura", charging: "In carica", face_id: "Face ID", changing_lang: "Cambio lingua..." },
            jp: { welcome: "スワイプして始める", mail: "メール", calendar: "カレンダー", photos: "写真", camera: "カメラ", maps: "マップ", clock: "時計", weather: "天気", wallet: "ウォレット", notes: "メモ", calculator: "電卓", settings: "設定", lang_region: "言語と地域", dark_mode: "ダークモード", charging: "充電中", face_id: "Face ID", changing_lang: "言語を変更中..." },
            cn: { welcome: "向上轻扫以开始", mail: "邮件", calendar: "日历", photos: "照片", camera: "相机", maps: "地图", clock: "时钟", weather: "天气", wallet: "钱包", notes: "备忘录", calculator: "计算器", settings: "设置", lang_region: "语言与地区", dark_mode: "深色模式", charging: "充电中", face_id: "Face ID", changing_lang: "正在更改语言..." }
        };
        let currentLang = 'es';

        // --- NEW YEAR CONFETTI LOGIC ---
        function runNewYearCelebration() {
            const canvas = document.getElementById('nyCanvas');
            const ctx = canvas.getContext('2d');
            const overlay = document.getElementById('newYearOverlay');
            
            // Set canvas size
            canvas.width = 380;
            canvas.height = 800;

            const particles = [];
            const colors = ['#FFD700', '#FF0000', '#00FF00', '#0000FF', '#FFFFFF', '#FFA500'];

            function createParticle() {
                return {
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    size: Math.random() * 5 + 2,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    speed: Math.random() * 3 + 2,
                    angle: Math.random() * 6.28,
                    spin: Math.random() * 0.2 - 0.1
                };
            }

            for(let i=0; i<100; i++) particles.push(createParticle());

            let animationId;
            function animateConfetti() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach((p, index) => {
                    p.y += p.speed;
                    p.angle += p.spin;
                    ctx.fillStyle = p.color;
                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.angle);
                    ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
                    ctx.restore();

                    if(p.y > canvas.height) {
                        particles[index] = createParticle();
                        particles[index].y = -10;
                    }
                });
                animationId = requestAnimationFrame(animateConfetti);
            }
            
            animateConfetti();

            // 5 SECONDS TIMER TO EXIT
            setTimeout(() => {
                overlay.classList.add('fade-out'); // Salida suave
                setTimeout(() => {
                    cancelAnimationFrame(animationId); // Stop confetti
                    overlay.style.display = 'none'; // Remove from flow
                }, 1000); // Wait for transition
            }, 5000);
        }

        // --- HELLO SEQUENCE ---
        const greetings = ["Provechito", "hello", "hola", "bonjour", "ciao", "hallo", "olá", "你好", "こんにちは", "Provechito"];
        let greetIdx = 0;
        const welcomeText = document.getElementById('welcomeText');
        
        const greetInterval = setInterval(() => {
            welcomeText.style.opacity = 0;
            setTimeout(() => {
                greetIdx = (greetIdx + 1) % greetings.length;
                welcomeText.innerText = greetings[greetIdx];
                welcomeText.style.opacity = 1;
            }, 500);
        }, 2000);

        function startSetup() {
            clearInterval(greetInterval);
            document.getElementById('notch').classList.remove('welcome-aura'); // Stop Aura
            document.getElementById('welcomeScreen').style.transform = "translateY(-100%)";
            document.getElementById('tutorialOverlay').style.display = "flex";
        }

        // --- LANGUAGE LOGIC ---
        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            
            // Animación Isla
            const n = document.getElementById('notch');
            n.classList.add('expanded-language');
            
            // Update Dynamic Island Texts immediately
            document.getElementById('langNotchText').textContent = t.changing_lang;
            document.getElementById('notchChargeText').textContent = t.charging + ' 100%';
            // Note: Face ID text is usually static "Face ID" brand, but we can translate if needed
            
            // Actualizar Textos UI (Claves data-key)
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if(t[key]) el.textContent = t[key];
            });
            
            // Actualizar Welcome Swipe Text
            document.getElementById('swipeText').textContent = t.welcome;
            
            // Actualizar Checkmarks
            document.querySelectorAll('.lang-check').forEach(i => i.style.display = 'none');
            document.getElementById('check-'+lang).style.display = 'block';
            
            // Texto Display Settings
            const langNames = {es:"Español", en:"English", fr:"Français", it:"Italiano", jp:"日本語", cn:"中文"};
            document.getElementById('currentLangDisplay').innerHTML = langNames[lang] + ' <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"/></svg>';

            // Simular Respring (Pantalla negra breve)
            setTimeout(() => {
                navSettings('back'); // Volver al menu principal
                n.classList.remove('expanded-language');
            }, 2000);
        }

        // --- SETTINGS NAVIGATION ---
        function navSettings(target) {
            const main = document.getElementById('setMain');
            const sub = document.getElementById('setLangs');
            const backBtn = document.getElementById('setBackBtn');
            const title = document.getElementById('setTitle');

            if (target === 'langs') {
                main.classList.add('hidden');
                sub.classList.remove('hidden');
                backBtn.style.visibility = 'visible';
                backBtn.innerText = translations[currentLang].settings || "Ajustes";
                backBtn.onclick = () => navSettings('back');
                title.innerText = translations[currentLang].lang_region || "Idioma";
            } else if (target === 'back') {
                main.classList.remove('hidden');
                sub.classList.add('hidden');
                backBtn.innerText = "Atrás";
                backBtn.onclick = () => closeApp('settings');
                title.innerText = translations[currentLang].settings || "Ajustes";
            }
        }

        // TUTORIAL
        function nextTut(n) {
            document.getElementById('tut'+n).classList.remove('active');
            document.getElementById('tut'+(n+1)).classList.add('active');
        }
        function closeTutorial() {
            document.getElementById('tutorialOverlay').style.display = "none";
        }

        // SYSTEM
        function updateClock() {
            const d = new Date();
            const t = d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
            document.getElementById('lockTime').innerText = t;
            document.getElementById('statusBarClock').innerText = t;
            const o = {weekday:'long', day:'numeric', month:'long'};
            document.getElementById('lockDate').innerText = d.toLocaleDateString(currentLang === 'es' ? 'es-ES' : 'en-US', o);
        }
        setInterval(updateClock, 1000); updateClock();

        function resize() {
            const s = Math.min((window.innerWidth-20)/380, (window.innerHeight-20)/800, 1);
            document.getElementById('scaler').style.transform = `scale(${s})`;
        }
        window.onresize = resize; 
        
        // INIT
        window.onload = function() {
            resize();
            runNewYearCelebration(); // START NEW YEAR SEQUENCE
        };

        function unlockPhone() {
            const n = document.getElementById('notch');
            n.classList.add('expanded-faceid');
            setTimeout(() => {
                n.classList.remove('expanded-faceid');
                document.getElementById('lockScreen').classList.add('unlocked');
            }, 1000);
        }

        function goHome() {
            document.querySelectorAll('.app-window').forEach(w => w.classList.remove('open'));
            clearInterval(cvcInterval);
            // RESET INDICATOR COLORS ON EXIT
            document.getElementById('homeIndicator').classList.remove('dark');
            document.getElementById('statusBar').classList.remove('dark');
        }

        const lightApps = ['mail', 'calendar', 'photos', 'maps', 'notes', 'settings', 'phone', 'safari', 'messages'];

        function openApp(id) {
            if(id === 'wallet') startWallet();
            if(id === 'camera') startCamera();
            const app = document.getElementById('app-' + id);
            if(app) {
                app.classList.add('open');
                // CHECK IF LIGHT APP AND APPLY DARK UI
                if(lightApps.includes(id)) {
                    document.getElementById('homeIndicator').classList.add('dark');
                    document.getElementById('statusBar').classList.add('dark');
                }
            }
        }
        function closeApp(id) {
            document.getElementById('app-' + id).classList.remove('open');
            if(id === 'wallet') clearInterval(cvcInterval);
            if(id === 'camera') stopCamera();
            goHome(); // Ensure colors reset
        }

        // SETTINGS & DARK MODE
        function toggleDark() {
            document.getElementById('iphoneFrame').classList.toggle('dark-mode');
            document.getElementById('darkToggle').classList.toggle('active');
        }
        function triggerChargeAnim() {
            const n = document.getElementById('notch');
            n.classList.add('expanded-charge');
            // Ensure text is updated based on current lang
            document.getElementById('notchChargeText').textContent = translations[currentLang].charging + ' 100%';
            setTimeout(() => n.classList.remove('expanded-charge'), 3000);
        }

        // CAMERA
        let videoStream;
        let filterIdx = 0;
        const filters = ['none', 'grayscale(1)', 'sepia(1)', 'saturate(2)'];
        async function startCamera() {
            try {
                videoStream = await navigator.mediaDevices.getUserMedia({ video: true });
                document.getElementById('camFeed').srcObject = videoStream;
            } catch(e) {}
        }
        function stopCamera() {
            if(videoStream) videoStream.getTracks().forEach(t => t.stop());
        }
        function toggleFilter() {
            filterIdx = (filterIdx + 1) % filters.length;
            document.getElementById('camFeed').style.filter = filters[filterIdx];
        }
        function takePhoto() {
            const c = document.getElementById('photoCanvas');
            const v = document.getElementById('camFeed');
            c.width = v.videoWidth; c.height = v.videoHeight;
            const ctx = c.getContext('2d');
            ctx.filter = filters[filterIdx];
            ctx.drawImage(v,0,0);
            document.getElementById('lastPhoto').src = c.toDataURL('image/jpeg');
            document.getElementById('lastPhoto').style.display = 'block';
        }

        // WALLET
        let cvcInterval;
        function startWallet() {
            let num = "";
            for(let i=0; i<4; i++) num += Math.floor(1000 + Math.random() * 9000) + " ";
            document.getElementById('walletNum').innerText = num.trim();

            function updateCVC() {
                document.getElementById('walletCVC').innerText = Math.floor(100 + Math.random() * 900);
                const bar = document.getElementById('cvcProgress');
                bar.style.transition = 'none'; bar.style.width = '100%';
                setTimeout(() => { bar.style.transition = 'width 30s linear'; bar.style.width = '0%'; }, 10);
            }
            updateCVC();
            clearInterval(cvcInterval);
            cvcInterval = setInterval(updateCVC, 30000);
        }

        // PHONE & CALC
        function dial(n) { document.getElementById('phoneDisplay').innerText += n; }
        let cVal = "0";
        function calc(v) {
            const d = document.getElementById('calcRes');
            if(v==='C') cVal="0";
            else if(v==='=') { try{cVal=eval(cVal)}catch{cVal="Error"} }
            else { if(cVal==="0") cVal=""; cVal+=v; }
            d.innerText = cVal;
        }

    </script>
</body>
</html>
